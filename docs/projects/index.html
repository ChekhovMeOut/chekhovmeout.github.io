<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Experience</title>
    <link rel="stylesheet" href="../style/style.css">
    <link rel="stylesheet" href="../style/card-style.css">
</head>
<body>
    <!-- Header -->
    <script src="../load-header.js"></script>

    <!-- Page Introduction -->
    <section class="section" justify-content="center">
            <div class="text-block-center">
                <h2>Personal Projects</h2>
                <h4>Finished and ongoing projects for academic interest, pleasure, or both. Projects are roughly ordered by recency.</h4>
            </div> 
    </section>

    <!-- Error & Loading Messages -->
    <section>
        <div id="loading" class="loading">Loading projects...</div>
        <div id="error" class="error" style="display: none;"></div>
        <div id="projects-container" class="projects-container"></div>
    </section>
    
    <!-- Footer -->
    <script src="../load-footer.js"></script>

    <script>
        // Load projects from JSON file
        async function loadProjects() {
            const loadingDiv = document.getElementById('loading');
            const errorDiv = document.getElementById('error');
            const container = document.getElementById('projects-container');

            try {
                const response = await fetch('project.json');
                const data = await response.json();

                loadingDiv.style.display = 'none';
                renderProjects(data.project);

            } catch (error) {
                console.error('Error loading projects:', error);
                loadingDiv.style.display = 'none';
                errorDiv.style.display = 'block';
                errorDiv.textContent = 'Failed to load projects. Please try again later.';
            }
        }
        
        // Create a project card element
        function createProjectCard(project) {
            const card = document.createElement('div');
            card.className = 'project-card';

            // Only add click event and style cursor if pageLink exists
            if (project.pageLink) {
                card.style.cursor = 'pointer';
                card.addEventListener('click', () => {
                    window.location.href = project.pageLink;
                });
            }
             // Add hover effects
            card.addEventListener('mouseenter', () => {
                card.style.border = '1px solid var(--color-accent)';
            });

            card.addEventListener('mouseleave', () => {
                card.style.border = '1px solid var(--color-border)';
            });

            card.innerHTML = `
                <img src="${project.hero}"
                     alt="${project.name}"
                     class="project-image"
                     onerror="this.outerHTML='<div class=\\'placeholder-image\\'>Image not available</div>'">

                <div class="project-content">
                    <h3 class="project-title">${project.name}</h3>
                    <p class="project-description">${project.description}</p>

                    <div class="project-technologies">
                        ${project.skills.map(skill =>
                            `<span class="tech-tag">${skill}</span>`
                        ).join('')}
                    </div>
                </div>
            `;

            return card;
        }

        // Render projects to the DOM
        function renderProjects(projects) {
            const container = document.getElementById('projects-container');
            
            // Sort projects by order field (lowest first)
            const sortedProjects = projects.sort((a, b) => {
                const orderA = a.order !== undefined ? a.order : 999;
                const orderB = b.order !== undefined ? b.order : 999;
                return orderA - orderB; // Flip to change sort order
            });
            
            // Render only visible projects
            sortedProjects.forEach(project => {
                if (project.visible === true) { 
                    const projectCard = createProjectCard(project);
                    container.appendChild(projectCard);
                }
            });  
        }

        // Load projects when the page loads
        document.addEventListener('DOMContentLoaded', loadProjects);
    </script>

<script>
    // Enhanced navigation highlighting for home page
    document.addEventListener('DOMContentLoaded', function() {
        // Add a small delay to ensure header is loaded
        setTimeout(function() {
            const homeLink = document.getElementById('nav-projects');
            if (homeLink) {
                homeLink.classList.add('active');
            }
        }, 100);
    });
</script>
</body>
</html>
